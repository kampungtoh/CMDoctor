<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çµèªèˆ‡è¦†ç›¤</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* é€™äº›æ¨£å¼éœ€è¦è¤‡è£½åˆ°æ¯å€‹ç¨ç«‹çš„å…§å®¹é é¢ä¸­ï¼Œä»¥ç¢ºä¿é¡¯ç¤ºä¸€è‡´æ€§ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; /* Changed to white */
        }
        .infographic-card {
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e2e8f0;
        }
        .infographic-section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 1rem;
            text-align: center;
        }
        .icon-large {
            font-size: 4rem;
            line-height: 1;
            display: block;
            margin: 0 auto 0.5rem; /* Centering the icon */
        }
        .list-center-items li {
            text-align: center;
            list-style-position: inside; /* Ensures the bullet is inside the centered text */
        }
        .signature-message, .quiz-message {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .signature-message.show, .quiz-message.show {
            opacity: 1;
        }
    </style>
</head>
<body class="p-4">
    <!-- Conclusion -->
    <div class="infographic-card bg-gradient-to-br from-blue-100 to-blue-200 text-center">
        <h2 class="infographic-section-title text-blue-700">çµèªï¼šå¥‡ç¾é†«å¸«ï¼ŒåŠ æ²¹ï¼</h2>
        <p class="text-gray-700 leading-relaxed mb-4">
            åŠ å…¥å¥‡ç¾é†«é™¢ï¼Œæ‚¨å°‡é–‹å•Ÿä¸€æ®µå……æ»¿æŒ‘æˆ°å’Œæˆé•·çš„è·æ¶¯æ—…ç¨‹ã€‚å¸Œæœ›é€™ä»½æ–°æ‰‹æ”»ç•¥èƒ½å¹«åŠ©æ‚¨å¿«é€Ÿé©æ‡‰ç’°å¢ƒï¼Œåœ¨å¥‡ç¾é†«é™¢ç™¼å…‰ç™¼ç†±ã€‚è¨˜ä½ï¼Œå¥‡ç¾é†«é™¢æ˜¯ä¸€å€‹å¤§å®¶åº­ï¼Œåœ¨é€™è£¡æ‚¨å°‡ç²å¾—æ”¯æŒã€é¼“å‹µå’Œæˆé•·çš„æ©Ÿæœƒã€‚ç¥æ‚¨åœ¨å¥‡ç¾é†«é™¢ä¸€åˆ‡é †åˆ©ï¼
        </p>
        <span class="icon-large">ğŸ‘</span>

        <div class="bg-white p-4 rounded-lg shadow-inner mt-6">
            <h3 class="font-bold text-xl text-blue-800 mb-3">é™¢é•·çš„è©±</h3>
            <p class="text-gray-700">
                è¦ªæ„›çš„æ–°é€²é†«å¸«å€‘ï¼Œæ­¡è¿æ‚¨åŠ å…¥å¥‡ç¾é†«é™¢é€™å€‹å¤§å®¶åº­ï¼æˆ‘å€‘æ·±çŸ¥é†«ç™‚å·¥ä½œçš„æŒ‘æˆ°èˆ‡è²¬ä»»ï¼Œä¹Ÿæ˜ç™½æ‚¨åœ¨é¢å°æ–°ç’°å¢ƒæ™‚å¯èƒ½æœ‰çš„ä¸å®‰ã€‚å¥‡ç¾é†«é™¢å§‹çµ‚ç§‰æŒã€é—œæ‡·ã€å°ˆæ¥­ã€æ•ˆç‡ã€çš„æ ¸å¿ƒåƒ¹å€¼ï¼Œè‡´åŠ›æ–¼æä¾›æœ€å„ªè³ªçš„é†«ç™‚æœå‹™ï¼ŒåŒæ™‚ä¹Ÿå°‡æ¯ä½åŒä»è¦–ç‚ºæœ€å¯¶è²´çš„è³‡ç”¢ã€‚åœ¨é€™è£¡ï¼Œæ‚¨å°‡æœ‰æ©Ÿæœƒèˆ‡é ‚å°–çš„é†«ç™‚åœ˜éšŠåˆä½œï¼Œä¸æ–·å­¸ç¿’æˆé•·ï¼Œä¸¦åœ¨è‡¨åºŠã€æ•™å­¸ã€ç ”ç©¶å„æ–¹é¢ç™¼å…‰ç™¼ç†±ã€‚æˆ‘å€‘æ‰¿è«¾æœƒæˆç‚ºæ‚¨æœ€å …å¯¦çš„å¾Œç›¾ï¼Œæä¾›å®Œå–„çš„è³‡æºèˆ‡æ”¯æŒï¼Œè®“æ‚¨èƒ½å¤ å®‰å¿ƒå·¥ä½œï¼Œå¯¦ç¾å€‹äººèˆ‡å°ˆæ¥­çš„ç†æƒ³ã€‚æœŸå¾…èˆ‡æ‚¨æ”œæ‰‹ï¼Œå…±åŒå®ˆè­·æ°‘çœ¾å¥åº·ï¼Œé–‹å‰µå¥‡ç¾é†«ç™‚çš„æ–°ç¯‡ç« ï¼
            </p>
            <br><br>
              <img src="https://sub.chimei.org.tw/57900/images/07_members/Hung-Jung-Lin.jpg" alt="æ—å®æ¦®é™¢é•·" class="mx-auto mb-4 rounded-md w-80">
              <div style="margin-top: 10px; font-weight: bold;">æ—å®æ¦®é™¢é•·</div>
          </div>
        </div>
    </div>

    <!-- Quiz Section -->
    <div class="infographic-card bg-gradient-to-br from-gray-100 to-gray-200">
        <h2 class="infographic-section-title text-gray-800">å°å•é¡Œè¦†ç›¤</h2>
        <form id="quizForm" class="space-y-6">
            <!-- Question 1 -->
            <div>
                <p class="font-semibold text-gray-800 mb-2">1. åœ¨å¥‡ç¾é†«é™¢å€¼ç­æ™‚é‡åˆ°ç–‘é›£é›œç—‡ï¼Œå¯ä»¥å‘èª°è«‹æ•™ï¼Ÿ</p>
                <div class="flex flex-col space-y-2">
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q1" value="a">
                        <span class="ml-2 text-gray-700">A. ç—…äºº</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q1" value="b">
                        <span class="ml-2 text-gray-700">B. å­¸é•·å§</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q1" value="c">
                        <span class="ml-2 text-gray-700">C. è­·ç†å¸«</span>
                    </label>
                </div>
            </div>

            <!-- Question 2 -->
            <div>
                <p class="font-semibold text-gray-800 mb-2">2. å¥‡ç¾é†«é™¢çš„æ ¸å¿ƒåƒ¹å€¼ä¸åŒ…å«ä¸‹åˆ—å“ªä¸€é …ï¼Ÿ</p>
                <div class="flex flex-col space-y-2">
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q2" value="a">
                        <span class="ml-2 text-gray-700">A. é—œæ‡·</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q2" value="b">
                        <span class="ml-2 text-gray-700">B. ä»æ…ˆ</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q2" value="c">
                        <span class="ml-2 text-gray-700">C. å°ˆæ¥­</span>
                    </label>
                </div>
            </div>

            <!-- Question 3 -->
            <div>
                <p class="font-semibold text-gray-800 mb-2">3. å¥‡ç¾é†«é™¢çš„å“¡å·¥å”åŠ©æ–¹æ¡ˆ(EAP)ä¸»è¦æä¾›å“ªç¨®æœå‹™ï¼Ÿ</p>
                <div class="flex flex-col space-y-2">
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q3" value="a">
                        <span class="ml-2 text-gray-700">A. å“¡å·¥æ—…éŠè¦åŠƒ</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q3" value="b">
                        <span class="ml-2 text-gray-700">B. å¿ƒç†è«®è©¢èˆ‡é—œæ‡·</span>
                    </label>
                    <label class="inline-flex items-center">
                        <input type="radio" class="form-radio text-blue-600" name="q3" value="c">
                        <span class="ml-2 text-gray-700">C. è–ªè³‡èª¿æ•´å»ºè­°</span>
                    </label>
                </div>
            </div>

            <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-md shadow-lg transition-all duration-300 transform hover:scale-105 w-full">
                æäº¤æ¸¬é©—
            </button>
        </form>
        <p id="quizMessage" class="quiz-message text-center mt-4"></p>
    </div>

    <!-- Signature Section -->
<div class="infographic-card bg-gradient-to-br from-gray-100 to-gray-200">
    <h2 class="infographic-section-title text-gray-800">é–±è®€ç¢ºèª</h2>
    <p class="text-gray-700 mb-4 text-center">è«‹è¼¸å…¥æ‚¨çš„äººäº‹è™Ÿä»¥ç¢ºèªå·²é–±è®€æœ¬æ”»ç•¥ï¼š</p>
    <div class="flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4">
        <input type="text" id="personnelIdInput" placeholder="æ‚¨çš„äººäº‹è™Ÿ" class="p-3 border border-gray-300 rounded-md w-full sm:w-auto flex-grow focus:outline-none focus:ring-2 focus:ring-blue-500">
        <button id="confirmReadButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-md shadow-lg transition-all duration-300 transform hover:scale-105">
            ç¢ºèªé–±è®€
        </button>
    </div>
    <p id="signatureMessage" class="signature-message text-green-600 font-semibold text-center mt-4"></p>
</div>

<script>
document.getElementById("confirmReadButton").addEventListener("click", function () {
    const staffId = document.getElementById("personnelIdInput").value.trim();
    const messageEl = document.getElementById("signatureMessage");

    // æª¢æŸ¥æ ¼å¼æ˜¯å¦ç‚º 6 ä½è‹±æ–‡å­—æ¯æˆ–æ•¸å­—
    if (!/^[A-Za-z0-9]{6}$/.test(staffId)) {
        messageEl.textContent = "âŒ äººäº‹è™Ÿæ ¼å¼éŒ¯èª¤ï¼Œè«‹è¼¸å…¥ 6 ä½è‹±æ–‡å­—æ¯æˆ–æ•¸å­—";
        messageEl.classList.remove("text-green-600");
        messageEl.classList.add("text-red-600");
        return;
    }

    // å–å¾—æ™‚é–“
    const now = new Date();
    const formattedTime = now.toLocaleString("zh-TW", {
        year: "numeric", month: "2-digit", day: "2-digit",
        hour: "2-digit", minute: "2-digit", second: "2-digit"
    });

    // æº–å‚™è³‡æ–™
    const formData = new URLSearchParams();
    formData.append("staffId", staffId);
    formData.append("completionTime", formattedTime);

    // é€å‡ºè³‡æ–™åˆ° Google Apps Script
    fetch("https://script.google.com/macros/s/AKfycbyaGf5OIM13FoDfFCwe7UxaRhqW5jPNpfzHlrorW7pOwqrgUStqw7bfNzRAupxeFv6GDQ/exec", {
        method: "POST",
        body: formData
    })
    .then(response => response.text())
    .then(data => {
        if (data.toLowerCase().includes("ok")) {
            messageEl.textContent = "âœ… å·²æˆåŠŸç´€éŒ„æ‚¨çš„ç¢ºèªæ™‚é–“ï¼Œè¬è¬æ‚¨ï¼";
            messageEl.classList.remove("text-red-600");
            messageEl.classList.add("text-green-600");
        } else {
            throw new Error("Google Script å›å‚³ç•°å¸¸");
        }
    })
    .catch(error => {
        console.error("é€å‡ºå¤±æ•—ï¼š", error);
        messageEl.textContent = "âš ï¸ ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯çµ¡ç®¡ç†å“¡";
        messageEl.classList.remove("text-green-600");
        messageEl.classList.add("text-red-600");
    });
});
</script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Quiz functionality
            const quizForm = document.getElementById('quizForm');
            const quizMessage = document.getElementById('quizMessage');
            const correctAnswers = {
                q1: 'b', // å­¸é•·å§
                q2: 'b', // ä»æ…ˆ (å¥‡ç¾æ ¸å¿ƒåƒ¹å€¼æ˜¯é—œæ‡·ã€å°ˆæ¥­ã€æ•ˆç‡ï¼Œå› æ­¤ä»æ…ˆä¸åŒ…å«åœ¨å…§)
                q3: 'b'  // å¿ƒç†è«®è©¢èˆ‡é—œæ‡·
            };

            quizForm.addEventListener('submit', (event) => {
                event.preventDefault(); // Prevent form submission

                let score = 0;
                let allAnswered = true;

                // Check each question
                for (const questionName in correctAnswers) {
                    const selectedOption = quizForm.querySelector(`input[name="${questionName}"]:checked`);
                    if (selectedOption) {
                        if (selectedOption.value === correctAnswers[questionName]) {
                            score++;
                        }
                    } else {
                        allAnswered = false;
                        break; // Stop if any question is not answered
                    }
                }

                if (!allAnswered) {
                    quizMessage.textContent = 'è«‹å®Œæˆæ‰€æœ‰é¡Œç›®å†æäº¤ã€‚';
                    quizMessage.classList.add('show');
                    quizMessage.style.color = 'red';
                    setTimeout(() => {
                        quizMessage.classList.remove('show');
                        quizMessage.style.color = ''; // Reset color
                    }, 3000);
                    return;
                }

                quizMessage.textContent = `æ‚¨ç­”å°äº† ${score} é¡Œï¼`;
                quizMessage.classList.add('show');
                quizMessage.style.color = score === Object.keys(correctAnswers).length ? 'green' : 'orange'; // Green if all correct, orange otherwise

                setTimeout(() => {
                    quizMessage.classList.remove('show');
                    quizMessage.style.color = ''; // Reset color
                }, 5000);
            });

            // Signature functionality
            const personnelIdInput = document.getElementById('personnelIdInput');
            const confirmReadButton = document.getElementById('confirmReadButton');
            const signatureMessage = document.getElementById('signatureMessage');

            confirmReadButton.addEventListener('click', () => {
                const personnelId = personnelIdInput.value.trim();
                if (personnelId) {
                    signatureMessage.textContent = `æ„Ÿè¬äººäº‹è™Ÿ ${personnelId} çš„é†«å¸«å®Œæˆé–±è®€æœ¬æ”»ç•¥ï¼ç¥æ‚¨åœ¨å¥‡ç¾é†«é™¢ä¸€åˆ‡é †åˆ©ï¼`;
                    signatureMessage.classList.add('show');
                    personnelIdInput.value = ''; // Clear input after signing
                    setTimeout(() => {
                        signatureMessage.classList.remove('show');
                    }, 5000); // Message disappears after 5 seconds
                } else {
                    signatureMessage.textContent = 'è«‹è¼¸å…¥æ‚¨çš„äººäº‹è™Ÿã€‚';
                    signatureMessage.classList.add('show');
                    signatureMessage.style.color = 'red';
                    setTimeout(() => {
                        signatureMessage.classList.remove('show');
                        signatureMessage.style.color = 'green'; // Reset color
                    }, 3000); // Error message disappears after 3 seconds
                }
            });
        });
    </script>
</body>
</html>

